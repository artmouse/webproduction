<h1>
    Загрузка прайса поставщика (ЗПП)
</h1>

<br/>
<h2>
    Главная страница ЗПП
</h2>

<p>
    CRM система OneBox предоставляет возможность загружать прайсы поставщиков для товаров из документов формата: CSV,
    XLS и XLSX. Этот функционал позволяет управлять ценами на товары, а также редактировать их вне системы.
    <br/>
    Он объединен в отдельный модуль «Загрузка прайса поставщика» или «Product-supplierprice», который подключается в
    главном конфигурационном файле.
</p>
<br/>

<p>
    Чтобы выполнить загрузку прайса поставщика нужно активировать выдвижную панель, которая находится в левой части
    экрана, затем нажать левой кнопкой мышки на пункт «Настройки».
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier1.png"/>
<br/>
<br/>

<p>
    Далее найдите пункт «Загрузка прайса поставщика» и кликните по нему.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier2.png"/>
<br/>
<br/>

<p>
    Страница для загрузки прайса выглядит следующим образом:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier3.png"/>
<br/>
<br/>

<p>
    Форма насчитывает большое количество полей, многие из которых являются обязательными для заполнения. Обязательные
    поля отмечены знаком (*).
</p>
<br/>

<p>
    «Выбран поставщик» - выпадающий список, который содержит все наименования поставщиков. За формирование списка
    отвечает отдельный функционал. Находится он в «Настройки» → «Поставщики».
    <br/>
    В случае, если по данному поставщику ранее загружались прайсы, то поля формы для загрузки будут заполнены
    автоматически.
</p>
<br/>

<p>
    «Выберите валюту поставщика» - список валют, в которой будут формироваться цены для продуктов.
    <br/>
    Важно! Существует возможность указывать валюту непосредственно в прайс-листе поставщика. Такая валюта будет
    приоритетней, чем валюта, установленная в системе. Это дает возможность работать с несколькими валютами, а также
    задавать валюту для каждого товара. Введите валютную аббревиатуру рядом с ценой товара и система распознает ее:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier11.png"/>
<br/>
<br/>

<p>
    Необходимо, чтобы валюта присутствовала в списке всех валют, с которыми работает система. Добавление новой валюты
    происходит через «Настройки» → «Валюты».
</p>
<br/>

<p>
    «Файл» - кнопка для того, чтобы приложить файл с прайсом поставщика. При добавлении файла в форме появится новый
    раздел «Файл превью» - в нем отображается только что добавленный документ. Под каждой колонкой документа находится
    выпадающий список. Он нужен, чтобы обозначить процесс распознавания прайса системой, например: указать, какая
    колонка в прайсе является кодом поставщика, названием продукта, его ценой и так далее. Это дает возможность
    загружать товары без перехода к тонким настройкам. Важно! Вышеописанные действия обязательны для корректной работы
    функционала. Альтернативным вариантом настройки распознавания происходит через ссылку «Тонкие настройки», это будет
    описано чуть ниже.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier13.png"/>
<br/>
<br/>

<p>
    «Тип файла» - выбор формата для прайса - поле обязательное для заполнения. Системе нужно указать тип прикладываемого
    файла, иначе она не сможет его распознать и выдаст ошибку. Если, к примеру, формат прикладываемого файла XLS, то
    отметьте radiobox «XLS».
    <br/>
    Для CSV-файлов предусмотрено несколько radiobox`ов. Они отличаются способом разделения колонок: через запятую, через
    точку с запятой, через табуляцию.
</p>
<br/>

<p>
    Часто встречается ситуация, когда исходный документ формата XLS или XLSX состоит из нескольких страниц. По умолчанию
    система считывает информацию со всех страниц последовательно.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier9.png"/>
<br/>
<br/>

<p>
    Чтобы обработать конкретные листы введите их номера в специальное поле через запятую: 1, 2, 3 и так далее.
    Подразумевается, что нумерация листов идет слева направо.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier10.png"/>
<br/>
<br/>

<p>
    «Кодировка файла» - еще одно обязательное поля для выбора кодировки прилагаемого документа.
</p>
<br/>

<p>
    Ниже находится ссылка «Тонкие настройки». Она ведет к ряду полей, которые нужны для правильного распознавания
    документа системой. Важно заполнить эти поля корректно, иначе информация с прайса будет считана неверно, в
    результате чего в базу данных попадут не те данные, которые ожидались. Клик по ссылке развернет форму.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier12.png"/>
<br/>
<br/>

<p>
    Первое поле отвечает за код продукта поставщика. Если в XLS-файле ячейки с этими данными находятся в первой
    колонке, значит в поле нужно также ввести 1. Для CSV-файлов порядок считается также.
    <br/>
    Все остальные поля: с названием, ценой, информацией о наличии продукта - заполняются аналогично.
</p>
<br/>

<p>
    Рядом с некоторыми полями имеются checkbox`ы для более тонкой настройки. Например, для поля с названием можно
    установить совпадение по названию в процентах. Это означает, что система будет пытаться идентифицировать
    наименования, не смотря на мелкие опечатки в прайс-листе.
    <br/>
    Напротив поля с ценой продукта находится checkbox, который запрещает импорт товаров без цены или с нулевой ценой.
</p>

<p>
    «Минимальная розничная цена» (МРЦ) - если при наценке по данному поставщику цена с наценкой выходит меньше МРЦ, то
    товару ставится цена МРЦ.
</p>
<br/>

<p>
    «Рекомендуемая розничная цена» (РРЦ) - если она указана у поставщика, по которому идет пересчет цен (по наценкам),
    то вне зависимости от результата наценки ставится данная цена.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier4.png"/>
<br/>
<br/>

<p>
    Важно! Ранее, из-за ограничения обрабатываемых строк нужно было грузить прайс "по частям". Например, указывать
    строки от 0 до 500, потом от 501 до 1000 и т.д. Сейчас такой необходимости нет: грузить можно весь прайс целиком,
    система обработает его корретно.
</p>
<br/>

<p>
    После того, как все поля формы были заполнены, следует нажать на кнопку «Загрузить следующий прайс». Важно! Кнопка
    «Начать загрузку» нужна непосредственно для импорта товаров, который происходит в фоне. Однако, прежде чем
    переходить к процессу импорта, система должна распознать прайс и выполнить связывание товаров (необязательно).
    <br/>
    Нажатие на «Загрузить следующий прайс» - позволяет выполнять загрузку несколько прайсов одновременно. То есть, к
    примеру, можно загрузить сразу 5-10 прайсов разных поставщиков, сформировав таким образом очередь (новый прайс
    ставит предыдущий в очередь). «Начать загрузку» - ведет к странице связывания (процесс связывания
    описан чуть ниже), где находятся все товары со всех прайсов и последующему импорту.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier5.png"/>
<br/>

<br/>
<br/>
<h2>
    Проверка документа на валидность
</h2>

<p>
    Далее произойдет переход на страницу «Убедитесь в валидности прайса и нажмите Подтвердить импорт», выглядит она
    следующим образом:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier6.png"/>
<br/>
<br/>

<p>
    Здесь, в таблице, отображается результат считывания информации с прайса. Продукты из базы сопоставляются с
    продуктами
    из прайса. В колонке «Найденный продукт» можно увидеть наименования продуктов из базы данных, к которым будет
    подгружена цена поставщика, указанная в прайсе.
    <br/>
    Большинство полей активируются нажатием левой кнопкой мышки - это может понадобиться для внесения
    быстрых правок.
    <br/>
    Пустые поля в колонке «Найденный продукт» означают, что товара, который указан в прайсе не существует в базе данных
    системы. Кроме того совпадения и несоответствия подсвечиваются разным цветом.
</p>
<br/>

<p>
    После проверки на валидность нажмите на кнопку «Подтвердить импорт в фоне», которая находится в нижней части экрана.
</p>
<br/>

<br/>
<br/>
<h2>
    Загрузка нескольких прайс-листов
</h2>

<p>
    Система выполнит переход к главной странице загрузки прайса поставщика. Теперь здесь появится таблица, которая
    отображает очередь загрузки прайсов. Это удобно, если нужно выполнить импорт нескольких прайсов.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier14.png"/>
<br/>
<br/>

<p>
    Очередь формируется при нажатии на кнопку «Загрузить следующий прайс». Важно при этом не забыть добавить новый
    документ с прайсом в поле «Файл», как было описано выше.
</p>
<br/>

<br/>
<br/>
<h2>
    Импорт товаров
</h2>

<p>
    Теперь можно выполнить загрузку прайс-листа, для этого нажмите на кнопку «Начать загрузку». После небольшой паузы на
    экране появится страница связывания продуктов:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier15.png"/>
<br/>
<br/>

<p>
    Данная страница напоминает страницу валидности. Однако в отличие от предыдущей она позволяет контролировать процесс
    импорта. Для этого нужно воспользоваться специальным набором полей справа от таблицы.
</p>
<br/>

<p>
    Поле «Поиск по товарам» - дает возможность искать уже существующие товары в базе. Введите код или номер товара в
    поле, затем нажмите на кнопку «Найти». Найденный товар появится чуть ниже. Его можно связать с товаром из прайса
    вручную. Это может оказать полезным, к примеру, если наименования товаров по каким-то причинам не совпали. Для этого
    методом drag`n`drop перетащите товар на нужную строчку прайса. Для наглядности строчка будет отмечена специальным
    блоком, это видно из скриншота:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier16.png"/>
<br/>
<br/>

<p>
    Также у такой строки в ячейке «Совпадение» появится отметка «Ручной выбор».
</p>
<br/>

<p>
    Поиск товаров можно расширить при помощи различных фильтров. Это даст возможность искать товар для связывания не
    только по его коду, но и по другим характеристикам. Работа с фильтрами происходит через пункт «Фильтры и
    характеристики». Подробней об это можно прочесть в разделе «Продукты» → «Фильтры товаров» → «Просмотр фильтров для
    товаров и их создание» или по этой
    <a href="/doc/product_filter_create_and_edit">
        ссылке
    </a>
    .
</p>
<br/>

<p>
    На странице результатов загрузки прайсов поставщика фильтр будет отображаться только в том случае, если он является
    основным. Для этого нужно активировать checkbox «Основной фильтр» в фильтре-характеристике.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier22.png"/>
<br/>
<br/>

<p>
    После этого основные фильтры будут отображаться под полем для поиска товаров.
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier23.png"/>
<br/>
<br/>

<p>
    Чуть ниже находится еще несколько немаловажных полей:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier7.png"/>
<br/>
<br/>

<p>
    «Удалить» - удаление товара из прайс-листа. Для этого отметьте галочкой checkbox конкретного товара, после чего
    воспользуйтесь кнопкой «Удалить».
</p>
<br/>

<p>
    Checkbox «Создать новые товары» - если, к примеру, цены к товарам загружаются в первый раз и заведомо известно, что
    перечень данных товаров отсутствует в базе данных, можно воспользоваться данным флагом. Он нужен для создания новых
    товаров из прайс-листа, если на данный момент они отсутствовали в базе данных.
    <br/>
    Для подтверждения изменений нажмите на кнопку «Импортировать все товары».
</p>
<br/>

<p>
    «Черный список» - возможность добавления товаров в черный список. Если товар попадает в черный список, то при
    дальнейших загрузках прайс-листов добавление или обновление такого товара происходить не будет. Чтобы внести товар в
    черный список нужно отметить его в поле checkbox, затем кликнуть на кнопку «В черный список».
    <br/>
    Просмотреть товары в черном списке можно в пункте «Список игнорируемых товаров ЗПП». Для этого активируйте меню
    OneBox, которое находится в левой части экрана, затем нажмите на пункт «Настройки» → «Список игнорируемых товаров
    ЗПП».
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier17.png"/>
<br/>
<br/>

<p>
    Товары, занесенные в черный список, объединены в таблицу:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier18.png"/>
<br/>
<br/>

<p>
    Чтобы исключить товар из черного списка отметьте его в поле checkbox, после чего нажмите на кнопку «Удалить».
</p>
<br/>

<p>
    После импорта товаров, чтобы убедиться, что товары, указанные в прайс-листе, были созданы, зайдите в список всех
    продуктов и воспользуйтесь
    панелью фильтрации для поиска конкретного продукта. Искомый товар должен быть найден. О том, как работать с
    продуктами в системе OneBox можно почитать в разделе «Продукты» → «Просмотр всех продуктов» или по этой
    <a href="/doc/product_show_all">
        ссылке
    </a>
    . О панели фильтрации продуктов написано
    <a href="/doc/product_filtration_panel">
        здесь
    </a>
    .
</p>
<br/>

<p>
    Данные о поставщиках, импортированные из прайс-листа, находятся в карточке товара. Их можно увидеть во вкладке
    «Поставщики».
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier8.png"/>
<br/>
<br/>

<p>
    Более подробно об этом функционале можно почитать в разделе «Продукты» → «Редактирование продукта» → «Управление
    поставщиками» или по этой
    <a href="/doc/product_supplier_manage">
        ссылке
    </a>
    .
</p>
<br/>

<br/>
<br/>
<h2>
    История загрузки товаров
</h2>

<p>
    Результат импорта товаров можно найти на вкладке «История загрузки товаров». Активируйте вкладку левой кнопкой
    мышки:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier19.png"/>
<br/>
<br/>

<p>
    История имеет вид таблицы:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier20.png"/>
<br/>
<br/>

<p>
    Здесь видно, когда прайс-лист прошел процедуру валидации и когда он был обработан. Также отображается количество
    добавленных или обновленных товаров, ошибки при импорте. Числовые показатели являются ссылками, которые ведут к
    отчетам по импорту. Отчеты выглядят следующим образом:
</p>
<br/>
<img alt="" src="/modules/product-supplierprice/docs/_images/supplier21.png"/>
<br/>
<br/>