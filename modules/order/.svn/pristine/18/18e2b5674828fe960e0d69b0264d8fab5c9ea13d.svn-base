<h1>
    Импорт и экспорт Excel
</h1>

<p>
    На данный момент CRM система OneBox позволяет выполнять импорт заказов из файлов с расширением XLS. Чтобы
    воспользоваться этим функционалом нужно активировать выдвижную панель, которая находится в левой части экрана, затем
    нажать левой кнопкой мышки на пункт «Заказы».
</p>
<br/>
<img alt="" src="/modules/order/docs/_images/order20.png"/>
<br/>
<br/>

<p>
    Вверху экрана находится вкладка «Импорт и экспорт Excel».
</p>
<br/>
<img alt="" src="/modules/order/docs/_images/order99.png"/>
<br/>
<br/>

<p>
    При нажатии на вкладку появится следующая страница:
</p>
<br/>
<img alt="" src="/modules/order/docs/_images/order100.png"/>
<br/>
<br/>

<p>
    Форма для загрузки файла включает в себя поле «Обзор...», которое дает возможность загрузить XLS-файл, а также
    кнопку «Закачать все данные из Excel» - служит для запуска импорта.
</p>
<br/>

<p>
    Чтобы импорт прошел корректно, нужно правильно составить XLS-документ. Каждая колонка в документе соответствует
    определенному полю для создания заказа в системе. К примеру, колонка «A» в ячейке «A1» содержит название поля
    «name», это значит, что в этой колонке должны находиться значения с именами заказов. Имена будут указаны в ячейках
    А2, А3 и так далее.
    <br/>
    Первая строка в XLS-файле (ячейки А1, В1, С1 и так далее) задает общую структуру документа, которая необходима для
    его корректного распознавания системой.
</p>
<br/>
<img alt="" src="/modules/order/docs/_images/order101.png"/>
<br/>
<br/>
<b>Таблица описания всех полей для импорта заказов:</b>
<br/>
<br/>
<table>
    <tr>
        <th>№</th>
        <th>Поле</th>
        <th>Описание</th>
        <th>Обязательное или нет, условия</th>
    </tr>
    <tr>
        <td>1</td>
        <td>name</td>
        <td>имя заказа</td>
        <td>Необязательное поле.</td>
    </tr>
    <tr>
        <td>2</td>
        <td>cdate</td>
        <td>дата создания заказа</td>
        <td>Необязательное поле. Если не указана, то ставится текущее время.</td>
    </tr>
    <tr>
        <td>3</td>
        <td>clientname</td>
        <td>имя клиента</td>
        <td rowspan="3">Поля служат для поиска клиента в базе. В случае, если ни одного клиента с
    заданным именем, телефоном или электронной почтой не найдено - система создаст нового клиента.</td>
    </tr>
    <tr>
        <td>4</td>
        <td>clientemail</td>
        <td>email клиента</td>
    </tr>
    <tr>
        <td>5</td>
        <td>clientphone</td>
        <td>телефон клиента</td>
    </tr>
    <tr>
        <td>6</td>
        <td>clientaddress</td>
        <td>адрес клиента/доставки</td>
        <td>Необязательное поле.</td>
    </tr>
    <tr>
        <td>7</td>
        <td>managername</td>
        <td>Ф.И.О. менеджера</td>
        <td>Необязательное поле. Если поле заполнено, система попытается найти менеджера в базе, и привязать его к заказу, если нету то она создаст его.</td>
    </tr>
    <tr>
        <td>8</td>
        <td>workflowname</td>
        <td>Название Бизнесс-процесса</td>
        <td>Обязательное поле. Это поле определяет бизнес-процесс, по которому будет строиться заказ. Если в базе данных указанного БП нет, то импорт заказа выполнен не будет.</td>
    </tr>
    <tr>
        <td>9</td>
        <td>statusname</td>
        <td>название статуса Бизнесс-процесса</td>
        <td>Обязательное поле. Это поле определяет статус заказа. Если в базе данных указанного статуса по данному БП нет, то импорт заказа выполнен не будет.</td>
    </tr>
    <tr>
        <td>10</td>
        <td>currency</td>
        <td>валюта</td>
        <td>Необязательное поле. При ее отсутствии система будет работать с валютой по умолчанию. Важно! Если
    указанная валюта отсутствует в системе, то импорт заказа выполнен не будет.</td>
    </tr>
    <tr>
        <td>11</td>
        <td>financepayed</td>
        <td>оплаченная сумма</td>
        <td>Необязательное поле, но в системе обязан быть хотябы 1 финансовый кошелёк или счет! </td>
    </tr>
    <tr>
        <td>12</td>
        <td>sourcename</td>
        <td>название источника заказа</td>
        <td>Необязательное поле. Если поле задано, то система попытается найти источник в базе, если нету то создаст, если есть то привяжет существующий.</td>
    </tr>
    <tr>
        <td>13</td>
        <td>product1name</td>
        <td>название продукта</td>
        <td rowspan="3">Необязательны для заполнения. Отвечают за привязку продуктов к заказу. В зависимости от количества товаров, они могут дублироваться. 
            Важно! При указании товара в документе система будет пытаться найти этот товар в базе данных. Если же
    в базе такого товара не окажется, то система создаст новый товар.</td>
    </tr>
    <tr>
        <td>14</td>
        <td>product1count</td>
        <td>количество продукта</td>       
    </tr>
    <tr>
        <td>15</td>
        <td>product1price</td>
        <td>цена продукта</td>
    </tr>
    <tr>
        <td>16</td>
        <td>product2name</td>
        <td>названите продукта2</td>
        <td rowspan="3">Если нужно, чтобы в заказе было два товара, то в документе должны присутствовать еще три дополнительные колонки, соответсвенно если больше то и колонок больше.</td>
    </tr>
    <tr>
        <td>17</td>
        <td>product2count</td>
        <td>количество продукта2</td>
    </tr>
    <tr>
        <td>18</td>
        <td>product2price</td>
        <td>цена продукта2</td>
    </tr>
    <tr>
        <td>...</td>
        <td>...</td>
        <td>...</td>
        <td>...</td>
    </tr>
</table>
<br /><br />
<br/>

<p>
    После завершения импорта заказов, их можно найти в таблице всех заказов. Подробней о том, как это сделать
    можно прочесть в разделе «Заказы» → «Просмотр всех заказов» или по этой
    <a href="/doc/orders_show_all">
        ссылке
    </a>
    .
</p>
<br/>